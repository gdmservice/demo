<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <title>GDM REPAIR SRL - Panou Admin</title>
  <style>
    /* Reset și font */
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f9fafb;
      margin: 0;
      padding: 30px;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
      color: #2c3e50;
    }
    
    /* Container principal */
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      padding: 25px 30px;
      border-radius: 10px;
      box-shadow: 0 4px 18px rgba(0,0,0,0.1);
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #34495e;
    }

    input[type="text"], select, textarea {
      width: 100%;
      padding: 10px 12px;
      font-size: 1rem;
      border-radius: 6px;
      border: 1.8px solid #d1d9e6;
      transition: border-color 0.3s ease;
    }
    input[type="text"]:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #2980b9;
      box-shadow: 0 0 8px #2980b9aa;
    }

    select {
      max-width: 100%;
      cursor: pointer;
    }

    /* Butoane */
    button {
      background-color: #2980b9;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 7px;
      font-size: 1rem;
      cursor: pointer;
      margin-top: 15px;
      box-shadow: 0 4px 8px #2980b9aa;
      transition: background-color 0.3s ease;
      user-select: none;
    }
    button:hover:not(:disabled) {
      background-color: #1f6391;
    }
    button:disabled {
      background-color: #9bbad6;
      cursor: not-allowed;
      box-shadow: none;
    }

    /* Flex container pentru detalii client */
    .detalii-client {
      margin-top: 25px;
      padding: 20px;
      background: #f0f4f9;
      border-radius: 10px;
      box-shadow: inset 0 0 10px #d3dbe9;
    }

    .detalii-client p {
      margin: 12px 0;
      font-size: 1.1rem;
      color: #2c3e50;
    }
    .detalii-client p b {
      display: inline-block;
      min-width: 140px;
      color: #34495e;
    }

    /* Lista piese */
    .piese-list ul {
      list-style: disc inside;
      padding-left: 10px;
      margin: 5px 0 0 0;
      color: #34495e;
    }

    /* SMS Box */
    .sms-box {
      background: #d1f1d1;
      padding: 15px;
      margin-top: 20px;
      border-radius: 8px;
      border: 1px solid #8ac38b;
      font-weight: 600;
      color: #2e7d32;
      box-shadow: 0 2px 6px #b6e1b6;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Status activ */
    #status-activ {
      position: fixed;
      top: 15px; right: 15px;
      background: #2980b9;
      color: white;
      padding: 15px 20px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 1rem;
      box-shadow: 0 0 15px #2980b9cc;
      max-width: 320px;
      text-align: center;
      z-index: 1100;
      user-select: none;
    }

    /* Căutare client */
    #cauta {
      max-width: 400px;
      margin-bottom: 20px;
      font-size: 1.1rem;
    }

    /* Section titluri */
    h3 {
      margin-top: 40px;
      margin-bottom: 15px;
      color: #34495e;
      border-bottom: 2px solid #2980b9;
      padding-bottom: 5px;
      user-select: none;
    }

    /* Ajustare dimensiune dropdown select client */
    #clientSelect {
      max-width: 350px;
      padding: 8px 10px;
      font-size: 1rem;
      border-radius: 6px;
      border: 1.8px solid #d1d9e6;
      transition: border-color 0.3s ease;
    }
    #clientSelect:focus {
      outline: none;
      border-color: #2980b9;
      box-shadow: 0 0 8px #2980b9aa;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>GDM REPAIR SRL - Panou Admin</h1>

    <label for="cauta">Caută client (nume sau cod):</label>
    <input type="text" id="cauta" oninput="filtreazaClienti()" placeholder="Ex: Ion Popescu sau GDM1234" autocomplete="off" />

    <label for="clientSelect">Selectează client:</label>
    <select id="clientSelect" onchange="afiseazaClientSelectat()" aria-label="Select client">
      <option value="">-- Alege client --</option>
    </select>

    <div class="detalii-client" id="detalii-client" aria-live="polite" aria-atomic="true">
      <p><b>Nume:</b> <span id="detalii-nume">-</span></p>
      <p><b>Telefon:</b> <span id="detalii-telefon">-</span></p>
      <p><b>Utilaj:</b> <span id="detalii-utilaj">-</span></p>
      <p><b>Status:</b>
        <select id="detalii-status" style="max-width: 200px;">
          <option value="Diagnosticare">Diagnosticare</option>
          <option value="Reparat">Reparat</option>
          <option value="Nereparat">Nereparat</option>
          <option value="Nu se mai repară">Nu se mai repară</option>
        </select>
      </p>
      <p><b>Cod client:</b> <span id="detalii-cod">-</span></p>
      <p><b>Data aducerii:</b> <span id="detalii-data">-</span></p>
      <p><b>Reparație contra cost:</b> <span id="detalii-contraCost">Nu</span></p>
      <p><b>Preț:</b> <span id="detalii-pret">0 RON</span></p>
      <p><b>Piese schimbate:</b>
        <div class="piese-list" id="detalii-piese">Nicio piesă adăugată</div>
      </p>

      <button onclick="salveazaModificariClient()" disabled id="btnSalveaza" aria-disabled="true" title="Salvează modificările clientului">Salvează modificări</button>
      <button onclick="adaugaPiesaClient()" disabled id="btnAdaugaPiesa" aria-disabled="true" title="Adaugă piesă schimbată clientului">Adaugă piesă schimbată</button>
    </div>

    <h3>Adaugă client nou</h3>
    <label for="numeNou">Nume client:</label>
    <input type="text" id="numeNou" autocomplete="off" />

    <label for="telefonNou">Telefon:</label>
    <input type="text" id="telefonNou" autocomplete="off" />

    <label for="utilajNou">Utilaj:</label>
    <input type="text" id="utilajNou" placeholder="Ex: Motocoasă, Drujbă" autocomplete="off" />

    <label for="statusNou">Status:</label>
    <select id="statusNou">
      <option value="Diagnosticare">Diagnosticare</option>
      <option value="Reparat">Reparat</option>
      <option value="Nereparat">Nereparat</option>
      <option value="Nu se mai repară">Nu se mai repară</option>
    </select>

    <label for="contraCostNou">Reparație contra cost:</label>
    <select id="contraCostNou">
      <option value="Nu">Nu</option>
      <option value="Da">Da</option>
    </select>

    <button onclick="adaugaClient()">Adaugă client nou</button>

    <div id="smsTrimis" class="sms-box" style="display:none;"></div>
  </div>

  <div id="status-activ" style="display:none;">Stare: Modificări salvate cu succes</div>

<script>
  // Date demo inițiale (sau încarcă din server mai târziu)
  let clienti = [
    {
      nume: "Ion Popescu",
      telefon: "0731234567",
      utilaj: "Motocoasă",
      status: "Diagnosticare",
      cod: "GDM1234",
      data: "2025-07-31",
      contraCost: "Nu",
      pret: 0,
      piese: []
    },
    {
      nume: "Maria Ionescu",
      telefon: "0747654321",
      utilaj: "Drujbă",
      status: "Reparat",
      cod: "GDM5678",
      data: "2025-07-20",
      contraCost: "Da",
      pret: 150,
      piese: ["Filtru aer", "Bujie"]
    }
  ];

  // Populează dropdown-ul cu lista de clienți, opțional filtrat
  function populateSelect(filtrat = null) {
    const select = document.getElementById('clientSelect');
    select.innerHTML = '<option value="">-- Alege client --</option>';
    const lista = filtrat || clienti;
    lista.forEach(c => {
      const opt = document.createElement('option');
      opt.value = c.cod;
      opt.textContent = `${c.nume} (${c.cod})`;
      select.appendChild(opt);
    });
  }

  // Filtrează clienții după nume sau cod când se scrie în căutare
  function filtreazaClienti() {
    const text = document.getElementById('cauta').value.toLowerCase().trim();
    if (text.length < 2) {
      populateSelect();
      return;
    }
    const filtrat = clienti.filter(c =>
      c.nume.toLowerCase().includes(text) ||
      c.cod.toLowerCase().includes(text)
    );
    populateSelect(filtrat);
  }

  // Afișează datele clientului selectat
  function afiseazaClientSelectat() {
    const select = document.getElementById('clientSelect');
    const codSelectat = select.value;
    if (!codSelectat) {
      golesteDetaliiClient();
      return;
    }
    const client = clienti.find(c => c.cod === codSelectat);
    if (!client) {
      golesteDetaliiClient();
      return;
    }
    document.getElementById('detalii-nume').textContent = client.nume;
    document.getElementById('detalii-telefon').textContent = client.telefon;
    document.getElementById('detalii-utilaj').textContent = client.utilaj;
    document.getElementById('detalii-status').value = client.status;
    document.getElementById('detalii-cod').textContent = client.cod;
    document.getElementById('detalii-data').textContent = client.data;
    document.getElementById('detalii-contraCost').textContent = client.contraCost;
    document.getElementById('detalii-pret').textContent = client.pret + " RON";

    // Listează piesele schimbate
    const pieseDiv = document.getElementById('detalii-piese');
    if (client.piese.length === 0) {
      pieseDiv.textContent = "Nicio piesă adăugată";
    } else {
      const ul = document.createElement('ul');
      client.piese.forEach(p => {
        const li = document.createElement('li');
        li.textContent = p;
        ul.appendChild(li);
      });
      pieseDiv.innerHTML = "";
      pieseDiv.appendChild(ul);
    }

    // Activează butoanele
    document.getElementById('btnSalveaza').disabled = false;
    document.getElementById('btnSalveaza').setAttribute('aria-disabled', 'false');
    document.getElementById('btnAdaugaPiesa').disabled = false;
    document.getElementById('btnAdaugaPiesa').setAttribute('aria-disabled', 'false');

    // Șterge mesajul SMS
    ascundeSmsTrimis();
  }

  // Golește zona de detalii când nu e client selectat
  function golesteDetaliiClient() {
    document.getElementById('detalii-nume').textContent = "-";
    document.getElementById('detalii-telefon').textContent = "-";
    document.getElementById('detalii-utilaj').textContent = "-";
    document.getElementById('detalii-status').value = "Diagnosticare";
    document.getElementById('detalii-cod').textContent = "-";
    document.getElementById('detalii-data').textContent = "-";
    document.getElementById('detalii-contraCost').textContent = "Nu";
    document.getElementById('detalii-pret').textContent = "0 RON";
    document.getElementById('detalii-piese').textContent = "Nicio piesă adăugată";

    document.getElementById('btnSalveaza').disabled = true;
    document.getElementById('btnSalveaza').setAttribute('aria-disabled', 'true');
    document.getElementById('btnAdaugaPiesa').disabled = true;
    document.getElementById('btnAdaugaPiesa').setAttribute('aria-disabled', 'true');

    ascundeSmsTrimis();
  }

  // Salvează modificările clientului curent selectat
  function salveazaModificariClient() {
    const cod = document.getElementById('detalii-cod').textContent;
    if (!cod || cod === "-") {
      alert("Selectați mai întâi un client.");
      return;
    }
    const client = clienti.find(c => c.cod === cod);
    if (!client) {
      alert("Clientul nu a fost găsit.");
      return;
    }
    const statusNou = document.getElementById('detalii-status').value;
    client.status = statusNou;

    // Actualizează lista piese dacă e nevoie (nu o schimbăm aici)

    afiseazaClientSelectat();
    afiseazaStatus("Modificări salvate cu succes");

    // Trimitere SMS fake simulare
    trimiteSmsClient(client);
  }

  // Adaugă client nou
  function adaugaClient() {
    const nume = document.getElementById('numeNou').value.trim();
    const telefon = document.getElementById('telefonNou').value.trim();
    const utilaj = document.getElementById('utilajNou').value.trim();
    const status = document.getElementById('statusNou').value;
    const contraCost = document.getElementById('contraCostNou').value;

    if (!nume || !telefon || !utilaj) {
      alert("Completați toate câmpurile obligatorii pentru client nou.");
      return;
    }

    // Generare cod unic (ex: GDM + 6 cifre random)
    let cod;
    do {
      cod = "GDM" + Math.floor(100000 + Math.random() * 900000);
    } while (clienti.find(c => c.cod === cod));

    const data = new Date().toISOString().slice(0, 10);

    const clientNou = {
      nume,
      telefon,
      utilaj,
      status,
      cod,
      data,
      contraCost,
      pret: 0,
      piese: []
    };

    clienti.push(clientNou);

    // Reîmprospătează lista și selectează clientul nou
    populateSelect();
    document.getElementById('clientSelect').value = cod;
    afiseazaClientSelectat();

    // Curățare câmpuri formular nou client
    document.getElementById('numeNou').value = "";
    document.getElementById('telefonNou').value = "";
    document.getElementById('utilajNou').value = "";
    document.getElementById('statusNou').value = "Diagnosticare";
    document.getElementById('contraCostNou').value = "Nu";

    afiseazaStatus("Client nou adăugat cu succes");
  }

  // Adaugă piesă schimbată la clientul selectat
  function adaugaPiesaClient() {
    const cod = document.getElementById('clientSelect').value;
    if (!cod) {
      alert("Selectați mai întâi un client.");
      return;
    }
    const piesa = prompt("Introduceți denumirea piesei schimbate:");
    if (!piesa || piesa.trim() === "") {
      alert("Numele piesei nu poate fi gol.");
      return;
    }
    const client = clienti.find(c => c.cod === cod);
    if (!client) {
      alert("Clientul nu a fost găsit.");
      return;
    }
    client.piese.push(piesa.trim());
    afiseazaClientSelectat();
    afiseazaStatus(`Piesa "${piesa.trim()}" adăugată.`);
  }

  // Mesaj status modificări vizibil 3 secunde
  function afiseazaStatus(msg) {
    const statusDiv = document.getElementById('status-activ');
    statusDiv.textContent = "Stare: " + msg;
    statusDiv.style.display = "block";
    setTimeout(() => {
      statusDiv.style.display = "none";
    }, 3000);
  }

  // Simulare trimitere SMS către client (doar mesaj în UI)
  function trimiteSmsClient(client) {
    let mesaj = `Salut, ${client.nume}! Statusul utilajului (${client.utilaj}) este: ${client.status}.`;
    if (client.contraCost === "Da") {
      mesaj += ` Preț: ${client.pret} RON.`;
    }
    const smsDiv = document.getElementById('smsTrimis');
    smsDiv.textContent = "Mesaj trimis către client:\n" + mesaj;
    smsDiv.style.display = "block";
  }

  // Ascunde mesajul SMS
  function ascundeSmsTrimis() {
    document.getElementById('smsTrimis').style.display = "none";
  }

  // Inițializează pagina
  window.onload = () => {
    populateSelect();
    golesteDetaliiClient();
  };
</script>
</body>
</html>
